<!DOCTYPE html>
<html>
<head>
<title>ImageLoader Demo</title>
</head>
<body>
<h1>ImageLoader Demo</h1>
<h2>What Is It</h2>
<p>The <code>ImageLoader</code> converts a <code>java.awt.Image</code> into a <code>java.awt.image.BufferedImage</code>.</p>
<h2>How To Use It</h2>
<p>There are three static methods:</p>
<pre>public MutableBufferedImage createImage(Image image)
public MutableBufferedImage createImage(File file)
public MutableBufferedImage createImage(URL url)</pre>
<p>Also three additional methods let you specify the image type (like <code>BufferedImage.TYPE_INT_ARGB</code>, or <code>BufferedImage.TYPE_3BYTE_BGR</code>):</p>
<pre>public MutableBufferedImage createImage(Image image, int imageType)
public MutableBufferedImage createImage(File file, int imageType)
public MutableBufferedImage createImage(URL url, int imageType)</pre>
<h2>How It Works</h2>
<p>It calls <code>Image.getSource()</code> to identify the <code>ImageProducer</code>. Then it attaches a custom <code>ImageConsumer</code> and populates a <code>BufferedImage</code> as image data becomes available.</p>
<p>If you specify a specific image type then the <code>com.pump.image.pixel.ImageType</code> classes are used to convert from one pixel type to another.</code>
<h2>Discussion</h2>
<p>Nothing about this class is especially clever, but it manages a lot of the tedious nuts and bolts of managing pixel data for you.</p>
<p>Originally I intended for the <code>ImageLoader</code> class to be an alternative to the <code>MediaTracker</code> class. But now with hindsight: now I think the <code>ImageLoader</code> is mostly an alternative to loading images with <code>ImageIO</code>. Both approaches produces a <code>BufferedImage</code>, which is nearly always what I prefer instead of a cryptic <code>java.awt.Image</code> from the <code>Toolkit</code>.</p>
<p>I'm not an expert regarding the <code>MediaTracker</code>, but I poked around a little bit and I found that internally it actually has a very similar approach to the <code>ImageLoader</code>: the <code>sun.awt.image.ImageRepresentation</code> also listens for pixel data and constructs a similar <code>BufferedImage</code>. If that class were part of the Java API I might not written the <code>ImageLoader</code>, but as it stands now: that class remains part of the <code>sun</code> package (although it is <code>public<code>).</p>
<p>Once I realized I was comparing the <code>ImageLoader</code> to <code>ImageIO</code>: I considered discarding the <code>ImageLoader</code>. They produce the same BufferedImage, and obviously <code>ImageIO</code> has a lot more work put into it. (You can swap parsers, read metadata, etc.) But to my surprise when I started measuring performance: it outperformed <code>ImageIO</code> by a small but constant margin. As of this writing (summer of 2022) when I measure the time it takes to load a large JPG on my Mac the results resemble:</p>
<br><img src="data:image/jvg;base64,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" alt="ImageLoader takes 1.1 s, ImageIO takes 1.2 s, and MediaTracker takes 1.3 s. Regarding memory ImageLoader takes 16.4 MB, ImageIO takes 23.3 MB, and MediaTracker takes 31.8 MB."/>
<p>Another JPG, though, produced startling results like this:</p>
<br><img src="data:image/jvg;base64,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" alt="ImageLoader and MediaTracker took under 5 seconds, and ImageIO took over 40 seconds."/>
<p>I'm not sure what the difference in those images is, though. They're both a similar size. Maybe I'm not intimate enough with the inner workings of JPEG compression, and there's an internal difference that requires different resources to parse? I tried graphing the three parsing models as the width increased:</p>
<img src="data:image/jvg;base64,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" alt="This shows all 3 model tracking upwards at a similar rate. The ImageLoader is slightly outperforming the MediaTracker and then ImageIO, but not by a significant margin."/>
<br>(In this particular test: the height was a constant of 1,000px. The image was the same (but scaled). The JPEG quality was 50%. I tried varying the JPEG quality but that didn't make a difference.)
<p>So as of this writing: I'm confident in saying the <code>ImageLoader</code> is a little bit more efficient. In some (maybe rare?) cases it is a lot more efficient, but I don't understand what separates those cases.</p>
</body>
</html>